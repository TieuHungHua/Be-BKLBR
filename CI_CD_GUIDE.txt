================================================================================
                    HÆ¯á»šNG DáºªN CI/CD SETUP
================================================================================

ğŸ“Œ Tá»”NG QUAN:
   ÄÃ£ táº¡o CI/CD pipeline vá»›i GitHub Actions Ä‘á»ƒ tá»± Ä‘á»™ng test, build vÃ  deploy
   backend NestJS khi cÃ³ code má»›i Ä‘Æ°á»£c push lÃªn repository.

================================================================================
ğŸ“ CÃC FILE ÄÃƒ Táº O
================================================================================

1. .github/workflows/ci.yml
   - GitHub Actions workflow
   - Tá»± Ä‘á»™ng cháº¡y test vÃ  build khi push/PR
   - Tá»± Ä‘á»™ng deploy khi merge vÃ o main/master

2. Dockerfile
   - Multi-stage build Ä‘á»ƒ tá»‘i Æ°u image size
   - Production-ready vá»›i health check

3. docker-compose.yml
   - Äá»ƒ cháº¡y local vá»›i Docker
   - Cáº¥u hÃ¬nh environment variables

4. .dockerignore
   - Loáº¡i trá»« cÃ¡c file khÃ´ng cáº§n thiáº¿t khá»i Docker image

5. .gitignore
   - Loáº¡i trá»« cÃ¡c file khÃ´ng cáº§n commit

================================================================================
ğŸ”§ SETUP GITHUB ACTIONS
================================================================================

BÆ¯á»šC 1: Táº¡o GitHub Repository
   1. Táº¡o repository má»›i trÃªn GitHub
   2. Push code lÃªn repository

BÆ¯á»šC 2: Cáº¥u hÃ¬nh Secrets
   VÃ o Settings > Secrets and variables > Actions
   ThÃªm cÃ¡c secrets sau:
   
   - DATABASE_URL: Connection string cá»§a database production
   - JWT_SECRET: Secret key cho JWT
   - CLOUDINARY_CLOUD_NAME: Cloudinary cloud name
   - CLOUDINARY_API_KEY: Cloudinary API key
   - CLOUDINARY_API_SECRET: Cloudinary API secret

BÆ¯á»šC 3: Push code
   Khi push code lÃªn branch main/master, workflow sáº½ tá»± Ä‘á»™ng cháº¡y:
   - Test
   - Build
   - Deploy (náº¿u cáº§n)

================================================================================
ğŸ³ DOCKER SETUP
================================================================================

1. BUILD DOCKER IMAGE:
   cd backend
   docker build -t backend-library .

2. RUN Vá»šI DOCKER:
   docker run -p 3000:3000 \
     -e DATABASE_URL="your-database-url" \
     -e JWT_SECRET="your-jwt-secret" \
     backend-library

3. RUN Vá»šI DOCKER COMPOSE:
   cd backend
   docker-compose up -d

4. XEM LOGS:
   docker-compose logs -f

5. STOP:
   docker-compose down

================================================================================
ğŸš€ DEPLOY OPTIONS
================================================================================

1. RAILWAY:
   - Káº¿t ná»‘i GitHub repo
   - Railway tá»± Ä‘á»™ng detect Dockerfile
   - Tá»± Ä‘á»™ng deploy khi cÃ³ code má»›i

2. RENDER:
   - Káº¿t ná»‘i GitHub repo
   - Chá»n Dockerfile
   - Cáº¥u hÃ¬nh environment variables
   - Auto-deploy enabled

3. VPS (DigitalOcean, AWS EC2, etc.):
   - SSH vÃ o server
   - Clone repo
   - Cháº¡y docker-compose up -d
   - Hoáº·c setup PM2 vá»›i npm run start:prod

4. HEROKU:
   - Káº¿t ná»‘i GitHub repo
   - Sá»­ dá»¥ng Heroku Container Registry
   - Deploy Docker image

================================================================================
ğŸ“‹ CI/CD WORKFLOW
================================================================================

Khi push code lÃªn GitHub:

1. TEST JOB:
   âœ“ Checkout code
   âœ“ Setup Node.js 20
   âœ“ Install dependencies
   âœ“ Generate Prisma Client
   âœ“ Run database migrations
   âœ“ Run linter
   âœ“ Run tests
   âœ“ Build application

2. DEPLOY JOB (chá»‰ cháº¡y trÃªn main/master):
   âœ“ Checkout code
   âœ“ Setup Node.js 20
   âœ“ Install dependencies
   âœ“ Build application
   âœ“ Deploy to production

================================================================================
ğŸ” SECURITY BEST PRACTICES
================================================================================

1. KHÃ”NG commit .env file
   - ÄÃ£ cÃ³ trong .gitignore
   - Sá»­ dá»¥ng GitHub Secrets cho CI/CD

2. Sá»­ dá»¥ng Secrets trong GitHub Actions
   - KhÃ´ng hardcode credentials
   - Táº¥t cáº£ sensitive data trong Secrets

3. Database migrations
   - Cháº¡y migrations trong CI/CD
   - Backup database trÆ°á»›c khi deploy

4. Health checks
   - Endpoint /health Ä‘á»ƒ monitor
   - Docker health check Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh

================================================================================
ğŸ§ª TESTING
================================================================================

CI/CD sáº½ tá»± Ä‘á»™ng cháº¡y:
- Unit tests (npm run test)
- E2E tests (npm run test:e2e)
- Linter (npm run lint)
- Build (npm run build)

Äáº£m báº£o táº¥t cáº£ tests pass trÆ°á»›c khi merge vÃ o main.

================================================================================
ğŸ“ CUSTOMIZE DEPLOYMENT
================================================================================

Äá»ƒ customize deployment, sá»­a file .github/workflows/ci.yml:

1. ThÃªm SSH deploy:
   - name: Deploy via SSH
     uses: appleboy/ssh-action@master
     with:
       host: ${{ secrets.HOST }}
       username: ${{ secrets.USERNAME }}
       key: ${{ secrets.SSH_KEY }}
       script: |
         cd /path/to/app
         git pull
         docker-compose up -d --build

2. ThÃªm deploy lÃªn Railway/Render:
   - Sá»­ dá»¥ng API cá»§a cÃ¡c platform
   - Hoáº·c dÃ¹ng GitHub integration (tá»± Ä‘á»™ng)

3. ThÃªm notification:
   - Slack
   - Discord
   - Email

================================================================================
âœ… CHECKLIST
================================================================================

â˜ ÄÃ£ táº¡o GitHub repository
â˜ ÄÃ£ push code lÃªn GitHub
â˜ ÄÃ£ thÃªm Secrets vÃ o GitHub
â˜ ÄÃ£ test workflow trÃªn branch khÃ¡c
â˜ ÄÃ£ cáº¥u hÃ¬nh deployment target
â˜ ÄÃ£ test Docker build local
â˜ ÄÃ£ test docker-compose local
â˜ ÄÃ£ setup monitoring/health checks

================================================================================
                    END OF GUIDE
================================================================================

